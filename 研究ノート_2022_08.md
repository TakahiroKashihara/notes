# **研究ノート_2022_8**


## **08/04**
- スペクトル関数の固有値が0以上であることを数値的に確かめた。

## **08/08**
- 量子計量：M=2.5はU=3.5まで計算した。
追加でU=5.0,6.5を計算した。
WilsonLoopがwell definedじゃなくなるという致命的な欠点に気づいた。Chern numberをグリーン関数で書いて計算するのがよいのではないかと大同さんに言われた。Ashishさんも分からないと言っていた。
- Green関数を使った表式では、$\omega > \mu$の部分と$\omega < \mu$の部分に分ければよい。前者が$G^R$に置き換えられ、後者が$G^A$に置き換えられる。
- 並列化しないと計算が重い。localではやりにくいかもしれない。一つのMに対し3分掛かった。しかも0.9ぐらいで微妙な値。

## **08/09**
- WilsonLoopは、自己エネルギーの虚部が小さければ無視して計算すればよい？少し計算した感じでは結果は同じ。
- ChernNumberをグリーン関数から計算するjuliaファイルを作った。SelfE(M,U,p)とし、p.Rとp.Nwが自動的に反映されるようにした。自己エネルギーも取り込める。値がきれいにならないのは、$\delta$のせいなのか、$Nw$のせいなのか分からない。deltaを1/2に、Nwを2倍にすると、M=1.5でのChern数が0.91から0.94に変わった。しかし時間は10分掛かる。おそらくNwとdelta両方変える必要がある。
- Chern数がU=1.4で既に小さくなっていて血の気が引いたが、おそらく今まで使っていた式は使うべきでない。今日見つけた、$\omega$微分を含んだ式を一般には使うべき。freeの場合は、$\omega$微$分が定数になってしまってきかない。しかし、相互作用あると、自己エネルギーの微分になるから単なる定数ではなくなる。

## **08/10**
- TKNNのグリーン関数での表記を、GRとGAで表す方法が分かった。
- 自己エネルギーの$\omega = 0$での値を見ると、$U=6.0$から少しずつ大きくなると分かった。これは、$n_a = 0.1$となる点と一致しており、GQMは少し増えている。
- M=1.5,U=4.8の結果は多分おかしい

## **08/18**
- DMFTのiteration回数を増やすファイルを作る。名前はQWZ_DMFTmany.sh。とりあえず、QWZ_DMFTtc.shと同じアルゴリズムで、U=5.7のファイルからiterationを20回で計算した。
- U=2.2でもtopoとQMの関係は変わらない。
- chern数の計算で、omega微分も導入したやり方で出来た。ただし、いったんomega微分を左に移す式を使った。また、chern数は1ではなく0.8程度になっていた。
- M=1.0、w=0での自己エネルギーの虚部は、トポロジカル相転移あたりで少しずつ大きくなっていた。急には増えない。もう一度iterationを増やしてDMFTをするか？
- M=1.0のU=6.65以降が収束していない。U=5.7,6.0,6.2,は収束。6.4,6.6は少し怪しい。
- 恐らく臨界点でDMFTがうまくいかないからだろう。
- M=1.5、U=3.4,3.5,3.6は収束。U=3.7は怪しい。4.1は収束していない！やばい！U=3.7,3.8,3.9をiteration20回でやり直した。DMFTをどんどん回して、GQMの計算をしたい。
- Selfdifでrawdataだとw=0で発散する点があるが、線形補完するとなくなる。これはいいことなのか？いったん良しとする。

## **08/19**
- DMFTmanyによるU=3.7,3.8,3.9の結果から、WilsonLoop,occupiednumber,DOSを計算した。大丈夫そう。変わらずトポロジカル相だった。
- 保存するDMFTのスクリプトを間違えていたので直した。
- M=1.5,U=3.7,3.9のGQMを計算し始めた。
- M=1.5,U=4.1,4.3,4.5のDMFTmanyを計算し始めた
- M=2.5の計算結果のチェック、DMFTの収束性のチェック、チャーン数のチェック(さっき回した)
- Chern数はそれっぽい結果を出している。しかし、変化が滑らかになってしまっていて、どこが相転移点なのかはっきり分からない。
- M=1.0、U=6.4,6.6,6.8のDMFTmanyを計算し始めた。ただし、QWZ_DMFTtcを使った。
- M=2.5のDMFTは、U=6.5,6.0,5.5,5.0,4.5,4.0,3.5,3.0,2.5,2.0,1.6,1.2,0.6,0.2で収束
- U=2.2での結果がおかしいと思ってslurmを見たら、何か並列化に関するエラーが出ている。02/01のM=1.5のときは出ていなかった。
- 06_16_qmtestはok
- 06_23_qmtestもok
- 06_28_qmtestもok
- 06_30_qmtestもok
- 07_08_qmtestもok
- 07_12_qmtestもok
- 07_13_qmtestもok
- 07_28_qmtestのM=1.85_U=0.022,M=1.95_U=0.022,M=1.75_U=0.022,M=1.9_U=0.022,M=2.0_U=0.022がおかしい。M=1.71までok.
- 仮説：tubagのworkが並列化に対応していない？おかしい、tubafでqmを計算するとエラーが出るようになっている。DMFTはエラーを出していなかったので、並列化は出来ているはず。linuxのコマンドdiffで調べる。qmwsieUg.jlは、2月から本質的に変化していない。昨日のDMFTは10並列だったから、並列数の問題ではない。
- 警告だから大丈夫なはず？じゃあ計算結果は正しい？
- とりあえずtubafのhomeでjuliaのパッケージをupdateした。
- U=0.022でChern数を確認
- パッケージアップデートをworkでもやる。なにも変化しなかった。連動しているのか？
- tuba4gでアップデートした。

## **08/22**
- M=1.5,U=5.3までDMFTの収束を確認した。M=1.0はU=6.6まで収束しているが、U=6.8で急に収束性が悪くなる。
- M=1.5のU=0.047,0.05,0.053でoccはok
- M=1.5,U=.0047,0.05のqmを実行した。最初は前回と同じ警告が出て実行されなかったが、もう一度juliaのupdateしたら出来た。
- M=1.0,U=0.07のDMFTを実行してみた。
- M=1.5のチャーン数は0っぽいので良かった。
- M=1.5でのチャーン数のU依存性をプロットした。
- M=1.5,U=0.057,0.06,0.063でのDMFTは収束している
- MarpでPetersさんに見せる資料を用意したい
- M=1.5のDMFT続きU=7.3まで実行した。
- U=3.7などのChernNumberも一応やりたい。
- SelfEnergyの虚部ももう一度調べたい
- M=1.0のU=7は収束していなかった。U=6.8で30回やってみる。
- M=2.5のqmをグラフにしたい。

## **08/23**
- U=0.68は30回やっても収束していない。18-20を見ると収束してるっぽいが、28-30を見ると収束していない。
- 自己エネルギーの虚部がギザギザする点が現れる。ここでおかしい気がする。M=1.5,U=0.057ぐらいから怪しい。
- Petersさんによると、U=6.3の少しのギザギザはあまり問題ない。昔のM=1.5,U=9.5のピークはもっと転移によるもの。
- QWZ_DMFTshare.jlを作った。これは、積分を並列化せず、配列を作るときに並列化するもの。qmwiseUg.jlと同じ。ファイルへの書き込みはすぐに終わるので、並列化は関係ないと思われる。
- U=5.7-6.3をiteration30回で実行した。
- M=1.5,U=7.3までは収束しているっぽいので続きをやる。
- **残っている問題：M=1.0,U=6.8が収束しない。**
- そろそろqmを計算しないとPetersさんに報告できない。最近計算機が埋まっていてやばいので計算する。
- Petersさんと話して、論文ではU=5.0ぐらいまで載せればよいという話になった。
- **今気づいたが、ozawaさんによるベリー曲率のバウンドは、有限なバンドでしか成り立たないか？無限次元のCauchy-Shwarzを考える必要がある。めんどくさい。**これは嘘(08/25　QGTの半正定値性から示せる)
- 計算したU=4.1,4.7のqmは前回と同じような感じ。大丈夫。
- U=3.8とU=5.3のqmをphucketに投げた。
- 10並列にしたDMFTは速度が変わっていない。並列化を道下さん式にしてみる
- **M=1.5,U=7.7,8.0,8.3はSigma20ではなく、Sigma19を見よ。**

## **08/25**
- 自己エネルギーのPHSによる影響は
$$
\mathrm{Im}\Sigma^{R}_A(\omega) = \mathrm{Im}\Sigma^{R}_B(-\omega)
$$

$$
U = \mathrm{Re} \Sigma^{R}_A(\omega) +  \mathrm{Re} \Sigma^{R}_B(-\omega)
$$
であることが理論的に示せた。$U$が小さいところのDMFTの結果を見ても正しそう。対称性をはじめから仮定したDMFTを作りたい。また、対称性を調べるコードも作りたい。
- 対称性をどうやって仮定するか？虚部は平均を取ればよい？実部は$U$を超えた分だけ両方から差っ引くか？
- PetersさんのDMFTのコードには$\omega = 0$がないことに気づいた。しかしプラスとマイナスがになっているので、平均を取るのもあり。
- PHScheck.jlで、DMFTの結果がPHSを満たしているかどうか調べられるようにした。PHS.shで実行可能。
- PHSは大体成り立っている。S0が対称性を守ってないように見えたのは、S0を作るときに両方$\omega = +0$を取ってきているからだと分かった。つまり、片方が$+0$なら、もう片方は$-0$にしなければ一致しないのは明らか。しかし、虚部が少しずつ増えていくことに変わりはないので、問題は解決していない。
- PHSをどう維持するかPetersさんと相談する。
- Petersさんに見せるグラフ：PHS、U=2.2のqm、ChernNumber、M=2.5のqm,M=1.5，k=20のGQM,M=2.5のSigmaの虚部

## **08/26**
- Petersさんに結果を報告した。
- PHS:Sigma_Aだけ計算して、対称性からもう片方を決めるやりかたと、平均を取って対称にする方法を提案された。
- チャーン数：量子化をきれいにみるために、wの積分範囲を広げることを提案された。Green関数は1/wの依存性だから。しかし、そこまでこだわらなくてよいともいわれた。
- U=2.2のGQMのグラフも論文に載せるべきだと言われた。
- M=2.5のqmがすこし大きくなっているのは、ギャップが小さくなっていることで説明できないかと言われた。スペクトル関数の幅を考慮したバンド図が作れないか？
- \Sigma_w=0は危険だという話があった。Mott絶縁体じゃないのにピークがある場合がある。また、S0の計算の際には平均を取った方がいいかもしれないという話になった。
- QWZ_DMFTphs.shを作った。100t_DMFTmany_08_19のM=1.5,U=5.0から始めよう。虚部が小さい。
- 解析計算のまとめをしたい。最初から最後までLatexモードでMarkdownで書けばよい。
- PHSを守ったDMFTが終わったと思ったら、SelfPHSが機能していなかった。もう一回やった(M=1.5,U=5.2)

## **08/29**
- PHSを守ったDMFTの計算ができた。slurmを見る限り、ちゃんと実行されている。しかし、phs.shで確認しようとすると、画像がうまく表示されなかった。
- ChernWideでU=0.043の結果がおかしい。しかも、なぜU=3.4でエラーが出ている？解決。U=0.034にすべきところを、U=0.34にしていた。

## **08/30**
- PHSを守ったDMFTでは、厳密にPHSが保たれていることを確認した。occ,DOSも問題なかった。
- U=0.055,0.058,0.061のPHSを保ったDMFTを実行した。
- S0meanbroad.jl,S0mean.jlを作り、$\omega = 0$の近傍で平均化された自己エネルギーを計算できるようにした。これまでの結果と比べると、M=1.5の場合において、PHSが保たれているように見える。しかし、少しずつ虚部が大きくなることは変わらない。
- U=0.055,0.058,0.061について、DOS,occは問題なし。
- しかし、虚部は少しずつ増えている。
- U=0.062,0.063,0.064のDMFTを実行した。
- U=0.062,0.063,0.064について、DOS,occは問題なし。
- しかし、虚部は少しずつ。
- U=0.065,0.066,0.067のDMFTを実行した。

## **09_01**
- DMFTは0.08まで実行した。収束は問題なさそうだが、Mott転移を見るのが難しい。例えば、U=0.077のDMFTの結果を見ると、虚部がとても大きいように見えるが、S0meanbroadではそれが見えない。平均化が悪いのか？
- いったん線形補完してみる。しかしきれいに見えない。
- occ,DOSの結果が、PHSを厳密に守らない場合と少し違う。occは0.02ぐらいちがう。DOSは$\omega = 0$のピークが違う気がする。U=8.0のoccは、前回の結果とほぼ同じだった。

## **09/02**
- PHSを仮定したDMFTの結果を用いたqmの結果を5並列で計算したのが終わった。時間は19時間ぐらい。妥当な計算時間だと思う。
- 計算した結果、GQMはU=6ぐらいで少し増えていたが、Petersさんはこの結果を論文に載せる必要はないといった。
- 道下さんにDMFTのコードを見せたが、問題ないとのことだった。
- Fubini-Study計量の、複素射影平面での局所座標表示から計算する方法について理解した。SSH模型の計算で、従来の定義と一致していることを確かめた。また、発散するのは、射影平面の元としてみたときに、不連続な点が現れるからだと分かった。

## **09/04**
- DMFTのdeltaを1/6にしたところ、今までの不連続性はなくなったが、ピークが$\omega = 0$から少しずれていた。100t_DMFTphs_dにある。なので、d=1/100にしてもう一度やってみた。100t_DMFTphs_d2にある。
- d=1/100にしても変わらない。もっと小さくするか。

## **09/08**
- d=1e-8にした100t_DMFT_d3_09_05の結果を見たが、DMFTが収束していなかった。もうだめだ。Uが大きいところはあきらめる。
- NRGのreviewを印刷した。研究室の机の横の棚に置いてある。
- spectral function の固有状態がどうなっているかを確認したい。数値計算から予想を立てて、何とか解析的に計算できないか？自己エネルギーの形をある程度仮定して、固有状態の形を導きたい。

## **09/10**
- spectral function の計算の際、自己エネルギーを手で入れてみて解析するのがよさそう。しかし、ギャップを閉じないといけない。両立できるのか？
- SSHでt1=t2にして、散逸を入れてみるか？散逸が無ければギャップが閉じているはず。
- 結局QWZ模型で、U=6.0の結果を用いて数値的に調べた。U=6.0ではspectral functionはk = 付近に[pi,pi]に値を持つが、$\omega = 0$において、そこで行列要素がほとんど0になっている。
- 今までのDOSは100倍されている？でもoccは？occは最後に$\omega$積分でp.Rを掛けるから相殺されている。DOSは多分100倍されてしまっている。スペクトル関数を積分したときに2になってよいと思っていたが、これもp.Rのおかげである。
- Uが大きいところのD.C.の伝導度は、行列要素が小さくなっているわけではなく、単にスペクトル関数が小さくなっている。なぜ？自己エネルギーの実部しかないはず。なぜギャップが閉じているように見えている？

## **09/20**
- spectral functionの半正定値性を解析的に示した。家のPCにmarkdownファイルでまとめてある。証明の方針は、QGTの半正定値性を示す時と似ている。
- U=2.2で、M=1.4,1.45,1.55のqmの計算を実行した。M=1.75は08_08_qmtest,M=1.5は01_30_qmtest,M=1.0は06_16_qmtestにある。
- M=1.5,U=3.5,3.6のqmの計算を実行した。自己エネルギーは、昔計算したものを採用した。
- qmの計算結果をグラフにするjuliaファイルmetricplot.jlを作った。

## **09/21**

- 昨日計算したqmの結果も含めて、qmのグラフを作った。それっぽい結果だったので良かった。
- wilsonloopの結果をグラフにするwilsonplot.jlを作った。phaseが一周していることを分かりやすくするために、$-\pi$から$\pi$までにした。


## **10/04**
- 量子ウォークについて少し調べた。量子ウォークにもトポロジカル相があり、シフト演算子をフーリエ変換したときにk依存性が出てきて、ベリー位相が定義できるという話を知った。では量子計量は？

## **10/17**
- スペクトル関数のheatmapを書こうとして気づいたが、qmwiseUg.jlのhsbzは、hsbz[1]が[0.,0.]になっていない。しかし、大した問題は無いと思う。
- spcetral関数のheatmapを作るコードを書いた。spectralmap.jlにある。実行はspmap.shでできる。$M=1.5,U=3.4$の結果は$k=[\pi,\pi]$でギャップが閉じていてそれっぽい結果だった。ARPESのreviewを見ると、電子同士の相関によるrenormalized bandにそっくりだった。これはおそらく、fermi 液体の場合は$\omega=0$で$Im \Sigma = 0$だからそこのスペクトルははっきり見えるのに対し、$\omega$が有限だと$Im \Sigma$も有限になり、ピークがぼやけるからだと思われる。
- heatmapをdatファイルにするのはなぜかまだできていない。

## **10/18**
- スペクトル関数のheatmapを作った。$\omega$の範囲を狭くして、heatmapを作るときのカラー指定を;c=afmhotにして作った。いい感じ。また、datファイルにするのができないように思えたのは、単に時間が掛かるだけだった。
- 有効ハミルトニアンからトポロジカル不変量を計算する理論的な論文を見たが、これは松原グリーン関数の場合だった。今回遅延グリーン関数を使っているが大丈夫なのか？松原の場合は、$H_\mathrm{eff}$がエルミートになる。

## **10/19**
- 遅延グリーン関数の実部と松原グリーン関数の実部は一致していないっぽい。ではどう正当化するのか？ピーター巣さんに質問したい。
- 英語の表現を探すときは、他の論文を見るか、Hyper allocationを見るとよいと知った。weblioも有効
- 最後にチャーン数の計算を回した。Grinvを定義するところだけ修正した。
- Chern数の結果がU=4.3でおかしく見えるのは、PHSがやぶれているからかもしれない。あまり気にしないのが良い。

## **10/25**
- Plotsのoptionについ色々調べた。数値計算マニュアルに少し書いている。一番苦労したのはheatmapのcolor_barの目盛りがLatex形式のfontにならないことだった。
- qmのsurfaceをもう一度作るため、計算機に$M=1.5,U=2.2$のjob投げた。

## **10/27**
- ダイレクト印刷を覚えた。凝縮wikiのIP使用状況からいける。439を選ぶ。

## **10/28**
- 本当は数日前にやっていたことだが、スペクトル関数を見たところ、実際は$\omega = 0$でギャップが閉じている。深刻なのは、$U=5.2$で、$\delta$をいくら小さくしてもギャップが閉じていること。しかし、$\omega = 0$直上ではDOSが無い。
- 論文はほとんど完成した。quantum volume とChern Numberのinequalityを指摘した。来週、道下さんとも確認して投稿できそう。
- 論文に使った図は少しずつ変更している。例えば、trgmapはxticksが変わっているし、qmfreeはyticksにpiが入っている。修士論文でもこちらの図を使うのがよい。
- 修士論発表会は1/30ぐらいらしい。提出は2週間前ぐらいか。
- 有限温度の計算をするなら、そろそろ計算を始めたい。

## **11/2**
- $U=0.0$でのGQMを論文に載せることになった。昔計算した結果を見ると、従来の定義をファイルに出力していなかったので、もう一度計算して出力する必要がある。
- 平均場近似の話と、$M_eff$も論文に載せることになったので作る。S0をまた計算しないといけない。めんどくさい。
- 比較する図は作った。metriccompare.jlにある。

## **11/4**
- U=0でのGQMの積分値を計算したところ、転移点付近で少し大きくなることが分かった。また、転移点付近では、M点でのみGQMの方が量子計量よりも小さくなっていることが分かった。
- ただ、各波数での図が見にくいので作り直した方がよい。ちゃんとdatファイルにある。

## **11/8**
- U=0でのGQMをいろんなMで調べたい。
- 既存の定義からは$Nk=100$にしてもそれほど変わらない。しかし、$M=0$付近での振る舞いが少し違う。$Nk=400$の図をそのまま使ってよさそう。
- M=0.1 0.2 0.3 0.5 1.0 1.5 1.98 1.99 2.0 2.01でjobを投げた。
- U=2.2についてはめんどくさいので64並列で投げた。
- 論文の修正：\epsilon_n>0
- 自己エネルギーの虚部は、M=1.5,U=2.2を見ると1e-4程度。それに対し。実部は0.8程度
- 論文のcaptionでWilsonLoopでなく$W(k_x)$と書いた
- 64並列ができていなかったので、cancelしてもう一回投げた。

## **11/10**
- GQMのU=0での計算は上手くいった。しかし、予想通りギャップが小さい所では値が大きくずれる。
- surfacemap.ipynbを作った。各波数でのGQMを読み込んで、surfaceをplotできる。
- GQMとexistの比較は、色やマーカーを調節したほうが良いと言われた。
- 図は完成した。後は文章を直すだけ。metricresult.jlでは色んなオプションが付いたplotが書いてあるので、困ったらそれも参考に。
- デフォルトの色が出せなくて困った。今度からデフォルトはあまり使わないでおこう。