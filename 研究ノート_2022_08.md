# **研究ノート_2022_8**


## **08/04**
- スペクトル関数の固有値が0以上であることを数値的に確かめた。

## **08/08**
- 量子計量：M=2.5はU=3.5まで計算した。
追加でU=5.0,6.5を計算した。
WilsonLoopがwell definedじゃなくなるという致命的な欠点に気づいた。Chern numberをグリーン関数で書いて計算するのがよいのではないかと大同さんに言われた。Ashishさんも分からないと言っていた。
- Green関数を使った表式では、$\omega > \mu$の部分と$\omega < \mu$の部分に分ければよい。前者が$G^R$に置き換えられ、後者が$G^A$に置き換えられる。
- 並列化しないと計算が重い。localではやりにくいかもしれない。一つのMに対し3分掛かった。しかも0.9ぐらいで微妙な値。

## **08/09**
- WilsonLoopは、自己エネルギーの虚部が小さければ無視して計算すればよい？少し計算した感じでは結果は同じ。
- ChernNumberをグリーン関数から計算するjuliaファイルを作った。SelfE(M,U,p)とし、p.Rとp.Nwが自動的に反映されるようにした。自己エネルギーも取り込める。値がきれいにならないのは、$\delta$のせいなのか、$Nw$のせいなのか分からない。deltaを1/2に、Nwを2倍にすると、M=1.5でのChern数が0.91から0.94に変わった。しかし時間は10分掛かる。おそらくNwとdelta両方変える必要がある。
- Chern数がU=1.4で既に小さくなっていて血の気が引いたが、おそらく今まで使っていた式は使うべきでない。今日見つけた、$\omega$微分を含んだ式を一般には使うべき。freeの場合は、$\omega$微$分が定数になってしまってきかない。しかし、相互作用あると、自己エネルギーの微分になるから単なる定数ではなくなる。

## **08/10**
- TKNNのグリーン関数での表記を、GRとGAで表す方法が分かった。
- 自己エネルギーの$\omega = 0$での値を見ると、$U=6.0$から少しずつ大きくなると分かった。これは、$n_a = 0.1$となる点と一致しており、GQMは少し増えている。
- M=1.5,U=4.8の結果は多分おかしい

## **08/18**
- DMFTのiteration回数を増やすファイルを作る。名前はQWZ_DMFTmany.sh。とりあえず、QWZ_DMFTtc.shと同じアルゴリズムで、U=5.7のファイルからiterationを20回で計算した。
- U=2.2でもtopoとQMの関係は変わらない。
- chern数の計算で、omega微分も導入したやり方で出来た。ただし、いったんomega微分を左に移す式を使った。また、chern数は1ではなく0.8程度になっていた。
- M=1.0、w=0での自己エネルギーの虚部は、トポロジカル相転移あたりで少しずつ大きくなっていた。急には増えない。もう一度iterationを増やしてDMFTをするか？
- M=1.0のU=6.65以降が収束していない。U=5.7,6.0,6.2,は収束。6.4,6.6は少し怪しい。
- 恐らく臨界点でDMFTがうまくいかないからだろう。
- M=1.5、U=3.4,3.5,3.6は収束。U=3.7は怪しい。4.1は収束していない！やばい！U=3.7,3.8,3.9をiteration20回でやり直した。DMFTをどんどん回して、GQMの計算をしたい。
- Selfdifでrawdataだとw=0で発散する点があるが、線形補完するとなくなる。これはいいことなのか？いったん良しとする。

## **08/19**
- DMFTmanyによるU=3.7,3.8,3.9の結果から、WilsonLoop,occupiednumber,DOSを計算した。大丈夫そう。変わらずトポロジカル相だった。
- 保存するDMFTのスクリプトを間違えていたので直した。
- M=1.5,U=3.7,3.9のGQMを計算し始めた。
- M=1.5,U=4.1,4.3,4.5のDMFTmanyを計算し始めた
- M=2.5の計算結果のチェック、DMFTの収束性のチェック、チャーン数のチェック(さっき回した)
- Chern数はそれっぽい結果を出している。しかし、変化が滑らかになってしまっていて、どこが相転移点なのかはっきり分からない。
- M=1.0、U=6.4,6.6,6.8のDMFTmanyを計算し始めた。ただし、QWZ_DMFTtcを使った。
- M=2.5のDMFTは、U=6.5,6.0,5.5,5.0,4.5,4.0,3.5,3.0,2.5,2.0,1.6,1.2,0.6,0.2で収束
- U=2.2での結果がおかしいと思ってslurmを見たら、何か並列化に関するエラーが出ている。02/01のM=1.5のときは出ていなかった。
- 06_16_qmtestはok
- 06_23_qmtestもok
- 06_28_qmtestもok
- 06_30_qmtestもok
- 07_08_qmtestもok
- 07_12_qmtestもok
- 07_13_qmtestもok
- 07_28_qmtestのM=1.85_U=0.022,M=1.95_U=0.022,M=1.75_U=0.022,M=1.9_U=0.022,M=2.0_U=0.022がおかしい。M=1.71までok.
- 仮説：tubagのworkが並列化に対応していない？おかしい、tubafでqmを計算するとエラーが出るようになっている。DMFTはエラーを出していなかったので、並列化は出来ているはず。linuxのコマンドdiffで調べる。qmwsieUg.jlは、2月から本質的に変化していない。昨日のDMFTは10並列だったから、並列数の問題ではない。
- 警告だから大丈夫なはず？じゃあ計算結果は正しい？
- とりあえずtubafのhomeでjuliaのパッケージをupdateした。
- U=0.022でChern数を確認
- パッケージアップデートをworkでもやる。なにも変化しなかった。連動しているのか？
- tuba4gでアップデートした。

## **08/22**
- M=1.5,U=5.3までDMFTの収束を確認した。M=1.0はU=6.6まで収束しているが、U=6.8で急に収束性が悪くなる。
- M=1.5のU=0.047,0.05,0.053でoccはok
- M=1.5,U=.0047,0.05のqmを実行した。最初は前回と同じ警告が出て実行されなかったが、もう一度juliaのupdateしたら出来た。
- M=1.0,U=0.07のDMFTを実行してみた。
- M=1.5のチャーン数は0っぽいので良かった。
- M=1.5でのチャーン数のU依存性をプロットした。
- M=1.5,U=0.057,0.06,0.063でのDMFTは収束している
- MarpでPetersさんに見せる資料を用意したい
- M=1.5のDMFT続きU=7.3まで実行した。
- U=3.7などのChernNumberも一応やりたい。
- SelfEnergyの虚部ももう一度調べたい
- M=1.0のU=7は収束していなかった。U=6.8で30回やってみる。
- M=2.5のqmをグラフにしたい。

## **08/23**
- U=0.68は30回やっても収束していない。18-20を見ると収束してるっぽいが、28-30を見ると収束していない。
- 自己エネルギーの虚部がギザギザする点が現れる。ここでおかしい気がする。M=1.5,U=0.057ぐらいから怪しい。
- Petersさんによると、U=6.3の少しのギザギザはあまり問題ない。昔のM=1.5,U=9.5のピークはもっと転移によるもの。
- QWZ_DMFTshare.jlを作った。これは、積分を並列化せず、配列を作るときに並列化するもの。qmwiseUg.jlと同じ。ファイルへの書き込みはすぐに終わるので、並列化は関係ないと思われる。
- U=5.7-6.3をiteration30回で実行した。
- M=1.5,U=7.3までは収束しているっぽいので続きをやる。
- **残っている問題：M=1.0,U=6.8が収束しない。**
- そろそろqmを計算しないとPetersさんに報告できない。最近計算機が埋まっていてやばいので計算する。
- Petersさんと話して、論文ではU=5.0ぐらいまで載せればよいという話になった。
- **今気づいたが、ozawaさんによるベリー曲率のバウンドは、有限なバンドでしか成り立たないか？無限次元のCauchy-Shwarzを考える必要がある。めんどくさい。**これは嘘(08/25　QGTの半正定値性から示せる)
- 計算したU=4.1,4.7のqmは前回と同じような感じ。大丈夫。
- U=3.8とU=5.3のqmをphucketに投げた。
- 10並列にしたDMFTは速度が変わっていない。並列化を道下さん式にしてみる
- **M=1.5,U=7.7,8.0,8.3はSigma20ではなく、Sigma19を見よ。**

## **08/25**
- 自己エネルギーのPHSによる影響は
$$
\mathrm{Im}\Sigma^{R}_A(\omega) = \mathrm{Im}\Sigma^{R}_B(-\omega)
$$

$$
U = \mathrm{Re} \Sigma^{R}_A(\omega) +  \mathrm{Re} \Sigma^{R}_B(-\omega)
$$
であることが理論的に示せた。$U$が小さいところのDMFTの結果を見ても正しそう。対称性をはじめから仮定したDMFTを作りたい。また、対称性を調べるコードも作りたい。
- 対称性をどうやって仮定するか？虚部は平均を取ればよい？実部は$U$を超えた分だけ両方から差っ引くか？
- PetersさんのDMFTのコードには$\omega = 0$がないことに気づいた。しかしプラスとマイナスがになっているので、平均を取るのもあり。
- PHScheck.jlで、DMFTの結果がPHSを満たしているかどうか調べられるようにした。PHS.shで実行可能。
- PHSは大体成り立っている。S0が対称性を守ってないように見えたのは、S0を作るときに両方$\omega = +0$を取ってきているからだと分かった。つまり、片方が$+0$なら、もう片方は$-0$にしなければ一致しないのは明らか。しかし、虚部が少しずつ増えていくことに変わりはないので、問題は解決していない。
- PHSをどう維持するかPetersさんと相談する。
- Petersさんに見せるグラフ：PHS、U=2.2のqm、ChernNumber、M=2.5のqm,M=1.5，k=20のGQM,M=2.5のSigmaの虚部

## **08/26**
- Petersさんに結果を報告した。
- PHS:Sigma_Aだけ計算して、対称性からもう片方を決めるやりかたと、平均を取って対称にする方法を提案された。
- チャーン数：量子化をきれいにみるために、wの積分範囲を広げることを提案された。Green関数は1/wの依存性だから。しかし、そこまでこだわらなくてよいともいわれた。
- U=2.2のGQMのグラフも論文に載せるべきだと言われた。
- M=2.5のqmがすこし大きくなっているのは、ギャップが小さくなっていることで説明できないかと言われた。スペクトル関数の幅を考慮したバンド図が作れないか？
- \Sigma_w=0は危険だという話があった。Mott絶縁体じゃないのにピークがある場合がある。また、S0の計算の際には平均を取った方がいいかもしれないという話になった。
- QWZ_DMFTphs.shを作った。100t_DMFTmany_08_19のM=1.5,U=5.0から始めよう。虚部が小さい。
- 解析計算のまとめをしたい。最初から最後までLatexモードでMarkdownで書けばよい。
- PHSを守ったDMFTが終わったと思ったら、SelfPHSが機能していなかった。もう一回やった(M=1.5,U=5.2)

## **08/29**
- PHSを守ったDMFTの計算ができた。slurmを見る限り、ちゃんと実行されている。しかし、phs.shで確認しようとすると、画像がうまく表示されなかった。
- ChernWideでU=0.043の結果がおかしい。しかも、なぜU=3.4でエラーが出ている？